# SQL Injection Detection Model

#### 网络空间安全数据挖掘技术 Task 5 Group 2

- 数据集选取：

  https://github.com/flywangfang258/ML-for-SQL-Injection/tree/master/ML_for_SQL/data



- 特征选取：
  1. Payload长度；
  2. 敏感数据库、表名检测；
  3. 敏感数据库查询词语检测；
  4. 敏感数据库函数检测；
  5. Payload最后是否被#、--+等注释方法截断；
  6. 大写字母数量。



- 对于特征的2、3、4项，我们建立了比较全面完整的词表作为字典，并且采用了指数增加的评分方式，也就是检测到一个分数+1，检测到第二个+2，第三个+4，以此来扩大该特征的影响度；因为对于一个Payload来说，若检测到大于一两个数据库相关的关键词，那我们大可推断这个Payload为SQL注入的Payload。



- 关于向量化之前的处理：
  - 我们在把每一个Payload向量化之前对其做了URL解码的处理，因为考虑到SQL注入语句也是由相关人员编写生成的，只是在传输过程中进行了编码，故我们的检测打算做在解码之后。



- 模型选择：

  决策树模型（Decision Tree）



- 模型评估：
  1. 准确率（Accuracy）：0.97 +/- 0.01；
  2. 召回率（Recall）：0.98 +/- 0.01。



- 测试用例
  - 放在了代码的最后一段，可自行输入进行测试。