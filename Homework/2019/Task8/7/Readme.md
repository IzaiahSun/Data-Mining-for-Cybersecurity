# 验证码破解

## 验证码

### 定义

验证码（CAPTCHA）是“Completely Automated Public Turing test to tell Computers and Humans Apart”（全自动区分计算机和人类的图灵测试）的缩写，是一种区分用户是计算机还是人的公共全自动程序。可以防止：恶意破解密码、刷票、论坛灌水，有效防止某个黑客对某一个特定注册用户用特定程序暴力破解方式进行不断的登陆尝试，实际上用验证码是现在很多网站通行的方式，我们利用比较简易的方式实现了这个功能。这个问题可以由计算机生成并评判，但是必须只有人类才能解答。由于计算机无法解答CAPTCHA的问题，所以回答出问题的用户就可以被认为是人类。

很多普通程序员在编写爬虫的时候，基本上都会遇到的环节——“**验证码**”。验证是一种**防止程序自动化**的一个措施，其最常见的表现形式就是看图识别字符。

验证码技术就是一种**反自动化**技术。本文所解决的问题则是，使用深度学习技术来实现“**全自动化的识别验证码**”。

### 分类

因为现在新的形式的验证产品很多，光从外界的展现形式上就有：

1. 完整滑动解锁式
2. 随机滑动拼图式
3. 随机点选汉字式
4. 图片分类选择式
5. 其它

本次研究图片分类验证码

### 验证码使用场景

随着深度学习技术在图像处理技术上越来越强大的表现，这些传统的纯依靠简单图片的码式验证已经没有任何的安全性可言，但是这些不安全的验证码却还存在于互联网的各个角落，存在于大互联网公司，基于像银行，证券和保险等等这些金融领域。这些主要的应用场景包括：**注册，登录，找回密码，抢购下单，评论，投票**等等。



## 数据集选择

根据自己定义的验证码生成算法生成了30万左右的验证码灰度图，文件名为其字符内容+文件格式后缀。



## 训练模型

### CNN

卷积神经网络（Convolutional Neural Networks, CNN）是一类包含卷积计算且具有深度结构的前馈神经网络（Feedforward Neural Networks），是深度学习（deep learning）的代表算法之一 。卷积神经网络具有表征学习（representation learning）能力，能够按其阶层结构对输入信息进行平移不变分类（shift-invariant classification），因此也被称为“平移不变人工神经网络（Shift-Invariant Artificial Neural Networks, SIANN）”。

卷积神经网络仿造生物的视知觉（visual perception）机制构建，可以进行监督学习和非监督学习，其隐含层内的卷积核参数共享和层间连接的稀疏性使得卷积神经网络能够以较小的计算量对格点化（grid-like topology）特征，例如像素和音频进行学习、有稳定的效果且对数据没有额外的特征工程（feature engineering）要求。



### 模型结构

#### 输入层

将预处理过的图像数据输入

#### 卷积层

由三个不完全相同的【卷积层、激活函数、池化层、Dropout】组成

1. 创建第一层卷积，激活函数relu，卷积核尺寸3*3，最大池化层尺寸2\*2
2. 创建第二层卷积，激活函数relu，卷积核尺寸3*3，最大池化层尺寸2\*2
3. 创建第三层函数，激活函数relu，卷积核尺寸3*3，最大池化层尺寸2\*2

#### 全连接层

由Flatten、Dropout、Dense组成

将池化后的数据摊平接入全连接网络，创建四个全连接层，分别识别4个字符

#### 输出层

生成的4个字符拼接输出



### 关键技术

#### EarlyStopping

 根据训练过程中损失函数值的变化情况决定是否提前结束训练 

#### LearningRateScheduler

 随着训练轮数的增加，自适应减小学习速率lr 



## 训练结果

| epoch | loss   | acc    | val_loss | cal_acc |
| ----- | ------ | ------ | -------- | ------- |
| 1     | 0.0551 | 0.9860 | 0.0935   | 0.9858  |
| 2     | 0.0347 | 0.9892 | 0.0871   | 0.9865  |
| 3     | 0.0317 | 0.9900 | 0.0855   | 0.9868  |
| 4     | 0.0301 | 0.9904 | 0.0856   | .09868  |
| ……    |        |        |          |         |
| 25    | 0.0238 | 0.9923 | 0.0865   | 0.9872  |
| 26    | 0.0237 | 0.9923 | 0.0863   | 0.9872  |
| 27    | 0.0237 | 0.9923 | 0.0865   | 0.9872  |
| 28    | 0.0237 | 0.9923 | 0.0865   | 0.9872  |

最后随机生成了1万张验证码尝试进行破解，破解成功率为0.44左右



## 改进意见

可以在验证码处理的时候进行去噪，去噪即去除图片中干扰目标的那些数据。对于验证码来说，其中的干扰线，边框之类的就属于干扰因子，因此需要想办法去干扰线，去边框。根据验证码中各个字符的关联程度可以选择切分还是不切分，如果字符连接程度比较高的话，就将验证码图片作为一个整体去训练，如果没有连接，那么可以将验证码切分成一个个字符去训练，这样的话训练的速度和效果理论上应该更好一点。